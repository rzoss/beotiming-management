<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BEO-Timing: md5/md5.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>md5/md5.cpp</h1><a href="md5_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00015"></a>00015 <span class="comment">/*</span>
<a name="l00016"></a>00016 <span class="comment"> * Functions to compute MD5 message digest of files or memory blocks</span>
<a name="l00017"></a>00017 <span class="comment"> * according to the definition of MD5 in RFC 1321 from April 1992.</span>
<a name="l00018"></a>00018 <span class="comment"> * Copyright (C) 1995, 1996 Free Software Foundation, Inc.  NOTE: The</span>
<a name="l00019"></a>00019 <span class="comment"> * canonical source of this file is maintained with the GNU C Library.</span>
<a name="l00020"></a>00020 <span class="comment"> * Bugs can be reported to bug-glibc@prep.ai.mit.edu.</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00023"></a>00023 <span class="comment"> * it under the terms of the GNU General Public License as published</span>
<a name="l00024"></a>00024 <span class="comment"> * by the Free Software Foundation; either version 2, or (at your</span>
<a name="l00025"></a>00025 <span class="comment"> * option) any later version.</span>
<a name="l00026"></a>00026 <span class="comment"> *</span>
<a name="l00027"></a>00027 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00028"></a>00028 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00029"></a>00029 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00030"></a>00030 <span class="comment"> * General Public License for more details.</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00033"></a>00033 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00034"></a>00034 <span class="comment"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</span>
<a name="l00035"></a>00035 <span class="comment"> * 02111-1307, USA.</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> * Written by Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt;, 1995.</span>
<a name="l00038"></a>00038 <span class="comment"> * Modified by Gray Watson &lt;http://256.com/gray/&gt;, 1997.</span>
<a name="l00039"></a>00039 <span class="comment"> *</span>
<a name="l00040"></a>00040 <span class="comment"> * $Id: md5.c,v 1.7 2006/03/05 15:38:09 gray Exp $</span>
<a name="l00041"></a>00041 <span class="comment"> */</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * NOTE: during quick performance tests on a Sun Sparc Ultra 1 and an</span>
<a name="l00045"></a>00045 <span class="comment"> * Alpha 255 300, these functions performed upwards of 3mb/sec</span>
<a name="l00046"></a>00046 <span class="comment"> * including disk I/O time.</span>
<a name="l00047"></a>00047 <span class="comment"> */</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">/*</span>
<a name="l00050"></a>00050 <span class="comment"> * MD5 Test Suite from RFC1321: http://ds.internic.net:/rfc/rfc1321.txt</span>
<a name="l00051"></a>00051 <span class="comment"> *</span>
<a name="l00052"></a>00052 <span class="comment"> * MD5 ("") = d41d8cd98f00b204e9800998ecf8427e</span>
<a name="l00053"></a>00053 <span class="comment"> * MD5 ("a") = 0cc175b9c0f1b6a831c399e269772661</span>
<a name="l00054"></a>00054 <span class="comment"> * MD5 ("abc") = 900150983cd24fb0d6963f7d28e17f72</span>
<a name="l00055"></a>00055 <span class="comment"> * MD5 ("message digest") = f96b697d7cb7938d525a2f31aaf161d0</span>
<a name="l00056"></a>00056 <span class="comment"> * MD5 ("abcdefghijklmnopqrstuvwxyz") = c3fcd3d76192e4007dfb496cca67e13b</span>
<a name="l00057"></a>00057 <span class="comment"> * MD5 ("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789") =</span>
<a name="l00058"></a>00058 <span class="comment"> * d174ab98d277d9f5a5611c2c9f419d9f</span>
<a name="l00059"></a>00059 <span class="comment"> * MD5 ("123456789012345678901234567890123456789012345678901234567890123456</span>
<a name="l00060"></a>00060 <span class="comment"> * 78901234567890") = 57edf4a22be3c955ac49da2e2107b67a</span>
<a name="l00061"></a>00061 <span class="comment"> */</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="preprocessor">#include "<a class="code" href="md5_8h.html" title="Diese Funktionen liefern die Moeglichkeit, einen MD5-Hash eines beliebigen String...">md5.h</a>"</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include "<a class="code" href="md5__loc_8h.html" title="Diese Funktionen liefern die Moeglichkeit, einen MD5-Hash eines beliebigen String...">md5_loc.h</a>"</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="keyword">static</span>  <span class="keywordtype">char</span>    *rcs_id =
<a name="l00071"></a>00071   <span class="stringliteral">"$Id: md5.c,v 1.7 2006/03/05 15:38:09 gray Exp $"</span>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">/* version id for the library */</span>
<a name="l00074"></a>00074 <span class="keyword">static</span> <span class="keywordtype">char</span> *version_id = <span class="stringliteral">"$MD5Version: 1.0.0 November-19-1997 $"</span>;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="comment">/****************************** local routines *******************************/</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/*</span>
<a name="l00079"></a>00079 <span class="comment"> * process_block</span>
<a name="l00080"></a>00080 <span class="comment"> *</span>
<a name="l00081"></a>00081 <span class="comment"> * DESCRIPTION:</span>
<a name="l00082"></a>00082 <span class="comment"> *</span>
<a name="l00083"></a>00083 <span class="comment"> * Process a block of bytes into a MD5 state structure.</span>
<a name="l00084"></a>00084 <span class="comment"> *</span>
<a name="l00085"></a>00085 <span class="comment"> * RETURNS:</span>
<a name="l00086"></a>00086 <span class="comment"> *</span>
<a name="l00087"></a>00087 <span class="comment"> * None.</span>
<a name="l00088"></a>00088 <span class="comment"> *</span>
<a name="l00089"></a>00089 <span class="comment"> * ARGUMENTS:</span>
<a name="l00090"></a>00090 <span class="comment"> *</span>
<a name="l00091"></a>00091 <span class="comment"> * md5_p - Pointer to MD5 structure from which we are getting the result.</span>
<a name="l00092"></a>00092 <span class="comment"> *</span>
<a name="l00093"></a>00093 <span class="comment"> * buffer - A buffer of bytes whose MD5 signature we are calculating.</span>
<a name="l00094"></a>00094 <span class="comment"> *</span>
<a name="l00095"></a>00095 <span class="comment"> * buf_len - The length of the buffer.</span>
<a name="l00096"></a>00096 <span class="comment"> */</span>
<a name="l00097"></a>00097 <span class="keyword">static</span>  <span class="keywordtype">void</span>    process_block(<a class="code" href="structmd5__t.html">md5_t</a> *md5_p, <span class="keyword">const</span> <span class="keywordtype">void</span> *buffer,
<a name="l00098"></a>00098                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buf_len)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100   <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>    correct[16];
<a name="l00101"></a>00101   <span class="keyword">const</span> <span class="keywordtype">void</span>    *buf_p = buffer, *end_p;
<a name="l00102"></a>00102   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  words_n;
<a name="l00103"></a>00103   <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>    A, B, C, D;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   words_n = buf_len / <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00106"></a>00106   end_p = (<span class="keywordtype">char</span> *)buf_p + words_n * <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   A = md5_p-&gt;<a class="code" href="structmd5__t.html#ab8fa915435774671caea7e7c6e63d19">md_A</a>;
<a name="l00109"></a>00109   B = md5_p-&gt;<a class="code" href="structmd5__t.html#1613a6a739dd0837c00af0e9a691b1e5">md_B</a>;
<a name="l00110"></a>00110   C = md5_p-&gt;<a class="code" href="structmd5__t.html#3d36bb26874ed330b76a40081317de8f">md_C</a>;
<a name="l00111"></a>00111   D = md5_p-&gt;<a class="code" href="structmd5__t.html#e4ca777e18b5fc82bf2ba0fd5a5b6ae6">md_D</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">/*</span>
<a name="l00114"></a>00114 <span class="comment">   * First increment the byte count.  RFC 1321 specifies the possible</span>
<a name="l00115"></a>00115 <span class="comment">   * length of the file up to 2^64 bits.  Here we only compute the</span>
<a name="l00116"></a>00116 <span class="comment">   * number of bytes with a double word increment.  Modified to do</span>
<a name="l00117"></a>00117 <span class="comment">   * this to better avoid overflows in the lower word -- Gray 10/97.</span>
<a name="l00118"></a>00118 <span class="comment">   */</span>
<a name="l00119"></a>00119   <span class="keywordflow">if</span> (md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] &gt; <a class="code" href="md5_8h.html#115bf68d9f4ca75cd56221a136ce689c">MAX_MD5_UINT32</a> - buf_len) {
<a name="l00120"></a>00120     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[1]++;
<a name="l00121"></a>00121     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] -= (<a class="code" href="md5_8h.html#115bf68d9f4ca75cd56221a136ce689c">MAX_MD5_UINT32</a> + 1 - buf_len);
<a name="l00122"></a>00122   }
<a name="l00123"></a>00123   <span class="keywordflow">else</span> {
<a name="l00124"></a>00124     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] += buf_len;
<a name="l00125"></a>00125   }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   <span class="comment">/*</span>
<a name="l00128"></a>00128 <span class="comment">   * Process all bytes in the buffer with MD5_BLOCK bytes in each</span>
<a name="l00129"></a>00129 <span class="comment">   * round of the loop.</span>
<a name="l00130"></a>00130 <span class="comment">   */</span>
<a name="l00131"></a>00131   <span class="keywordflow">while</span> (buf_p &lt; end_p) {
<a name="l00132"></a>00132     <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>  A_save, B_save, C_save, D_save;
<a name="l00133"></a>00133     <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>  *corr_p = correct;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     A_save = A;
<a name="l00136"></a>00136     B_save = B;
<a name="l00137"></a>00137     C_save = C;
<a name="l00138"></a>00138     D_save = D;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="comment">/*</span>
<a name="l00141"></a>00141 <span class="comment">     * Before we start, one word to the strange constants.  They are</span>
<a name="l00142"></a>00142 <span class="comment">     * defined in RFC 1321 as</span>
<a name="l00143"></a>00143 <span class="comment">     *</span>
<a name="l00144"></a>00144 <span class="comment">     * T[i] = (int) (4294967296.0 * fabs (sin (i))), i=1..MD5_BLOCK</span>
<a name="l00145"></a>00145 <span class="comment">     */</span>
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <span class="comment">/* Round 1. */</span>
<a name="l00148"></a>00148     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (A, B, C, D, buf_p, corr_p,  7, 0xd76aa478);
<a name="l00149"></a>00149     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (D, A, B, C, buf_p, corr_p, 12, 0xe8c7b756);
<a name="l00150"></a>00150     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (C, D, A, B, buf_p, corr_p, 17, 0x242070db);
<a name="l00151"></a>00151     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (B, C, D, A, buf_p, corr_p, 22, 0xc1bdceee);
<a name="l00152"></a>00152     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (A, B, C, D, buf_p, corr_p,  7, 0xf57c0faf);
<a name="l00153"></a>00153     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (D, A, B, C, buf_p, corr_p, 12, 0x4787c62a);
<a name="l00154"></a>00154     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (C, D, A, B, buf_p, corr_p, 17, 0xa8304613);
<a name="l00155"></a>00155     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (B, C, D, A, buf_p, corr_p, 22, 0xfd469501);
<a name="l00156"></a>00156     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (A, B, C, D, buf_p, corr_p,  7, 0x698098d8);
<a name="l00157"></a>00157     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (D, A, B, C, buf_p, corr_p, 12, 0x8b44f7af);
<a name="l00158"></a>00158     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (C, D, A, B, buf_p, corr_p, 17, 0xffff5bb1);
<a name="l00159"></a>00159     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (B, C, D, A, buf_p, corr_p, 22, 0x895cd7be);
<a name="l00160"></a>00160     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (A, B, C, D, buf_p, corr_p,  7, 0x6b901122);
<a name="l00161"></a>00161     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (D, A, B, C, buf_p, corr_p, 12, 0xfd987193);
<a name="l00162"></a>00162     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (C, D, A, B, buf_p, corr_p, 17, 0xa679438e);
<a name="l00163"></a>00163     <a class="code" href="md5__loc_8h.html#ea05e0e1ca3cc9eb2f4b248bf86a590b">OP1</a> (B, C, D, A, buf_p, corr_p, 22, 0x49b40821);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="comment">/* Round 2. */</span>
<a name="l00166"></a>00166     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D, correct[  1],  5, 0xf61e2562);
<a name="l00167"></a>00167     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, correct[  6],  9, 0xc040b340);
<a name="l00168"></a>00168     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, correct[ 11], 14, 0x265e5a51);
<a name="l00169"></a>00169     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A, correct[  0], 20, 0xe9b6c7aa);
<a name="l00170"></a>00170     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D, correct[  5],  5, 0xd62f105d);
<a name="l00171"></a>00171     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, correct[ 10],  9, 0x02441453);
<a name="l00172"></a>00172     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, correct[ 15], 14, 0xd8a1e681);
<a name="l00173"></a>00173     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A, correct[  4], 20, 0xe7d3fbc8);
<a name="l00174"></a>00174     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D, correct[  9],  5, 0x21e1cde6);
<a name="l00175"></a>00175     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, correct[ 14],  9, 0xc33707d6);
<a name="l00176"></a>00176     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, correct[  3], 14, 0xf4d50d87);
<a name="l00177"></a>00177     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A, correct[  8], 20, 0x455a14ed);
<a name="l00178"></a>00178     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, A, B, C, D, correct[ 13],  5, 0xa9e3e905);
<a name="l00179"></a>00179     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, D, A, B, C, correct[  2],  9, 0xfcefa3f8);
<a name="l00180"></a>00180     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, C, D, A, B, correct[  7], 14, 0x676f02d9);
<a name="l00181"></a>00181     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#5b02b4f5acc69dd3dae769e317cafba8">FG</a>, B, C, D, A, correct[ 12], 20, 0x8d2a4c8a);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">/* Round 3. */</span>
<a name="l00184"></a>00184     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D, correct[  5],  4, 0xfffa3942);
<a name="l00185"></a>00185     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C, correct[  8], 11, 0x8771f681);
<a name="l00186"></a>00186     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, correct[ 11], 16, 0x6d9d6122);
<a name="l00187"></a>00187     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, correct[ 14], 23, 0xfde5380c);
<a name="l00188"></a>00188     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D, correct[  1],  4, 0xa4beea44);
<a name="l00189"></a>00189     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C, correct[  4], 11, 0x4bdecfa9);
<a name="l00190"></a>00190     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, correct[  7], 16, 0xf6bb4b60);
<a name="l00191"></a>00191     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, correct[ 10], 23, 0xbebfbc70);
<a name="l00192"></a>00192     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D, correct[ 13],  4, 0x289b7ec6);
<a name="l00193"></a>00193     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C, correct[  0], 11, 0xeaa127fa);
<a name="l00194"></a>00194     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, correct[  3], 16, 0xd4ef3085);
<a name="l00195"></a>00195     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, correct[  6], 23, 0x04881d05);
<a name="l00196"></a>00196     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, A, B, C, D, correct[  9],  4, 0xd9d4d039);
<a name="l00197"></a>00197     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, D, A, B, C, correct[ 12], 11, 0xe6db99e5);
<a name="l00198"></a>00198     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, C, D, A, B, correct[ 15], 16, 0x1fa27cf8);
<a name="l00199"></a>00199     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#2755ce913ebfebd237cf80feb99a0a59">FH</a>, B, C, D, A, correct[  2], 23, 0xc4ac5665);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <span class="comment">/* Round 4. */</span>
<a name="l00202"></a>00202     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D, correct[  0],  6, 0xf4292244);
<a name="l00203"></a>00203     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, correct[  7], 10, 0x432aff97);
<a name="l00204"></a>00204     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, correct[ 14], 15, 0xab9423a7);
<a name="l00205"></a>00205     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A, correct[  5], 21, 0xfc93a039);
<a name="l00206"></a>00206     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D, correct[ 12],  6, 0x655b59c3);
<a name="l00207"></a>00207     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, correct[  3], 10, 0x8f0ccc92);
<a name="l00208"></a>00208     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, correct[ 10], 15, 0xffeff47d);
<a name="l00209"></a>00209     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A, correct[  1], 21, 0x85845dd1);
<a name="l00210"></a>00210     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D, correct[  8],  6, 0x6fa87e4f);
<a name="l00211"></a>00211     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, correct[ 15], 10, 0xfe2ce6e0);
<a name="l00212"></a>00212     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, correct[  6], 15, 0xa3014314);
<a name="l00213"></a>00213     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A, correct[ 13], 21, 0x4e0811a1);
<a name="l00214"></a>00214     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, A, B, C, D, correct[  4],  6, 0xf7537e82);
<a name="l00215"></a>00215     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, D, A, B, C, correct[ 11], 10, 0xbd3af235);
<a name="l00216"></a>00216     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, C, D, A, B, correct[  2], 15, 0x2ad7d2bb);
<a name="l00217"></a>00217     <a class="code" href="md5__loc_8h.html#943a15a4fa9e5f60a6b66a6fcce01bf5">OP234</a> (<a class="code" href="md5__loc_8h.html#c8cd4262e1565a47dfbbb66be56e3e6c">FI</a>, B, C, D, A, correct[  9], 21, 0xeb86d391);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <span class="comment">/* Add the starting values of the context. */</span>
<a name="l00220"></a>00220     A += A_save;
<a name="l00221"></a>00221     B += B_save;
<a name="l00222"></a>00222     C += C_save;
<a name="l00223"></a>00223     D += D_save;
<a name="l00224"></a>00224   }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="comment">/* Put checksum in context given as argument. */</span>
<a name="l00227"></a>00227   md5_p-&gt;<a class="code" href="structmd5__t.html#ab8fa915435774671caea7e7c6e63d19">md_A</a> = A;
<a name="l00228"></a>00228   md5_p-&gt;<a class="code" href="structmd5__t.html#1613a6a739dd0837c00af0e9a691b1e5">md_B</a> = B;
<a name="l00229"></a>00229   md5_p-&gt;<a class="code" href="structmd5__t.html#3d36bb26874ed330b76a40081317de8f">md_C</a> = C;
<a name="l00230"></a>00230   md5_p-&gt;<a class="code" href="structmd5__t.html#e4ca777e18b5fc82bf2ba0fd5a5b6ae6">md_D</a> = D;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="comment">/*</span>
<a name="l00234"></a>00234 <span class="comment"> * md5_get_result</span>
<a name="l00235"></a>00235 <span class="comment"> *</span>
<a name="l00236"></a>00236 <span class="comment"> * DESCRIPTION:</span>
<a name="l00237"></a>00237 <span class="comment"> *</span>
<a name="l00238"></a>00238 <span class="comment"> * Copy the resulting MD5 signature from MD5_P into the first 16 bytes</span>
<a name="l00239"></a>00239 <span class="comment"> * (MD5_SIZE) of the result buffer.</span>
<a name="l00240"></a>00240 <span class="comment"> *</span>
<a name="l00241"></a>00241 <span class="comment"> * RETURNS:</span>
<a name="l00242"></a>00242 <span class="comment"> *</span>
<a name="l00243"></a>00243 <span class="comment"> * None.</span>
<a name="l00244"></a>00244 <span class="comment"> *</span>
<a name="l00245"></a>00245 <span class="comment"> * ARGUMENTS:</span>
<a name="l00246"></a>00246 <span class="comment"> *</span>
<a name="l00247"></a>00247 <span class="comment"> * md5_p - Pointer to MD5 structure from which we are getting the result.</span>
<a name="l00248"></a>00248 <span class="comment"> *</span>
<a name="l00249"></a>00249 <span class="comment"> * result - A 16 byte buffer that will contain the MD5 signature.</span>
<a name="l00250"></a>00250 <span class="comment"> */</span>
<a name="l00251"></a>00251 <span class="keyword">static</span>  <span class="keywordtype">void</span>    md5_get_result(<span class="keyword">const</span> <a class="code" href="structmd5__t.html">md5_t</a> *md5_p, <span class="keywordtype">void</span> *result)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253   <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>    hold;
<a name="l00254"></a>00254   <span class="keywordtype">void</span>          *res_p = result;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   hold = SWAP(md5_p-&gt;<a class="code" href="structmd5__t.html#ab8fa915435774671caea7e7c6e63d19">md_A</a>);
<a name="l00257"></a>00257   memcpy(res_p, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00258"></a>00258   res_p = (<span class="keywordtype">char</span> *)res_p + <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260   hold = SWAP(md5_p-&gt;<a class="code" href="structmd5__t.html#1613a6a739dd0837c00af0e9a691b1e5">md_B</a>);
<a name="l00261"></a>00261   memcpy(res_p, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00262"></a>00262   res_p = (<span class="keywordtype">char</span> *)res_p + <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   hold = SWAP(md5_p-&gt;<a class="code" href="structmd5__t.html#3d36bb26874ed330b76a40081317de8f">md_C</a>);
<a name="l00265"></a>00265   memcpy(res_p, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00266"></a>00266   res_p = (<span class="keywordtype">char</span> *)res_p + <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   hold = SWAP(md5_p-&gt;<a class="code" href="structmd5__t.html#e4ca777e18b5fc82bf2ba0fd5a5b6ae6">md_D</a>);
<a name="l00269"></a>00269   memcpy(res_p, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00270"></a>00270 }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="comment">/***************************** exported routines *****************************/</span>
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">/*</span>
<a name="l00275"></a>00275 <span class="comment"> * md5_init</span>
<a name="l00276"></a>00276 <span class="comment"> *</span>
<a name="l00277"></a>00277 <span class="comment"> * DESCRIPTION:</span>
<a name="l00278"></a>00278 <span class="comment"> *</span>
<a name="l00279"></a>00279 <span class="comment"> * Initialize structure containing state of MD5 computation. (RFC 1321,</span>
<a name="l00280"></a>00280 <span class="comment"> * 3.3: Step 3).  This is for progressive MD5 calculations only.  If</span>
<a name="l00281"></a>00281 <span class="comment"> * you have the complete string available, md5_buffer should be used.</span>
<a name="l00282"></a>00282 <span class="comment"> * md5_process should be called for each bunch of bytes and after the</span>
<a name="l00283"></a>00283 <span class="comment"> * last process call, md5_finish should be called to get the</span>
<a name="l00284"></a>00284 <span class="comment"> * signature.</span>
<a name="l00285"></a>00285 <span class="comment"> *</span>
<a name="l00286"></a>00286 <span class="comment"> * RETURNS:</span>
<a name="l00287"></a>00287 <span class="comment"> *</span>
<a name="l00288"></a>00288 <span class="comment"> * None.</span>
<a name="l00289"></a>00289 <span class="comment"> *</span>
<a name="l00290"></a>00290 <span class="comment"> * ARGUMENTS:</span>
<a name="l00291"></a>00291 <span class="comment"> *</span>
<a name="l00292"></a>00292 <span class="comment"> * md5_p - Pointer to md5 structure that we are initializing.</span>
<a name="l00293"></a>00293 <span class="comment"> */</span>
<a name="l00294"></a><a class="code" href="md5_8h.html#eb46e2a63662d4994071a043b5f7f6c7">00294</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#4534cfa15307cc94f1e557fb6238698e">md5_init</a>(<a class="code" href="structmd5__t.html">md5_t</a> *md5_p)
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296   md5_p-&gt;<a class="code" href="structmd5__t.html#ab8fa915435774671caea7e7c6e63d19">md_A</a> = 0x67452301;
<a name="l00297"></a>00297   md5_p-&gt;<a class="code" href="structmd5__t.html#1613a6a739dd0837c00af0e9a691b1e5">md_B</a> = 0xefcdab89;
<a name="l00298"></a>00298   md5_p-&gt;<a class="code" href="structmd5__t.html#3d36bb26874ed330b76a40081317de8f">md_C</a> = 0x98badcfe;
<a name="l00299"></a>00299   md5_p-&gt;<a class="code" href="structmd5__t.html#e4ca777e18b5fc82bf2ba0fd5a5b6ae6">md_D</a> = 0x10325476;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301   md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] = 0;
<a name="l00302"></a>00302   md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[1] = 0;
<a name="l00303"></a>00303   md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a> = 0;
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 <span class="comment">/*</span>
<a name="l00307"></a>00307 <span class="comment"> * md5_process</span>
<a name="l00308"></a>00308 <span class="comment"> *</span>
<a name="l00309"></a>00309 <span class="comment"> * DESCRIPTION:</span>
<a name="l00310"></a>00310 <span class="comment"> *</span>
<a name="l00311"></a>00311 <span class="comment"> * This function is used to progressively calculate a MD5 signature some</span>
<a name="l00312"></a>00312 <span class="comment"> * number of bytes at a time.  If you have the complete string</span>
<a name="l00313"></a>00313 <span class="comment"> * available, md5_buffer should be used.  The MD5 structure should</span>
<a name="l00314"></a>00314 <span class="comment"> * have been initialized with md5_init and after the last process</span>
<a name="l00315"></a>00315 <span class="comment"> * call, md5_finish should be called to get the results.</span>
<a name="l00316"></a>00316 <span class="comment"> *</span>
<a name="l00317"></a>00317 <span class="comment"> * RETURNS:</span>
<a name="l00318"></a>00318 <span class="comment"> *</span>
<a name="l00319"></a>00319 <span class="comment"> * None.</span>
<a name="l00320"></a>00320 <span class="comment"> *</span>
<a name="l00321"></a>00321 <span class="comment"> * ARGUMENTS:</span>
<a name="l00322"></a>00322 <span class="comment"> *</span>
<a name="l00323"></a>00323 <span class="comment"> * md5_p - Pointer to MD5 structure which we are progressively updating.</span>
<a name="l00324"></a>00324 <span class="comment"> *</span>
<a name="l00325"></a>00325 <span class="comment"> * buffer - A buffer of bytes whose MD5 signature we are calculating.</span>
<a name="l00326"></a>00326 <span class="comment"> *</span>
<a name="l00327"></a>00327 <span class="comment"> * buf_len - The length of the buffer.</span>
<a name="l00328"></a>00328 <span class="comment"> */</span>
<a name="l00329"></a><a class="code" href="md5_8h.html#4560b471c3530ca3b13a8c9cfcb59761">00329</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#39eb2828c65f0846e6894a04df859f5c">md5_process</a>(<a class="code" href="structmd5__t.html">md5_t</a> *md5_p, <span class="keyword">const</span> <span class="keywordtype">void</span> *buffer,
<a name="l00330"></a>00330                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buf_len)
<a name="l00331"></a>00331 {
<a name="l00332"></a>00332   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  len = buf_len;
<a name="l00333"></a>00333   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  in_block, <span class="keyword">add</span>;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="comment">/*</span>
<a name="l00336"></a>00336 <span class="comment">   * When we already have some bytes in our internal buffer, copy some</span>
<a name="l00337"></a>00337 <span class="comment">   * from the user to fill the block.</span>
<a name="l00338"></a>00338 <span class="comment">   */</span>
<a name="l00339"></a>00339   <span class="keywordflow">if</span> (md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a> &gt; 0) {
<a name="l00340"></a>00340     
<a name="l00341"></a>00341     in_block = md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a>;
<a name="l00342"></a>00342     <span class="keywordflow">if</span> (in_block + len &gt; <span class="keyword">sizeof</span>(md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>)) {
<a name="l00343"></a>00343       <span class="keyword">add</span> = <span class="keyword">sizeof</span>(md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>) - in_block;
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345     <span class="keywordflow">else</span> {
<a name="l00346"></a>00346       <span class="keyword">add</span> = len;
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     memcpy (md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a> + in_block, buffer, <span class="keyword">add</span>);
<a name="l00350"></a>00350     md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a> += <span class="keyword">add</span>;
<a name="l00351"></a>00351     in_block += <span class="keyword">add</span>;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="keywordflow">if</span> (in_block &gt; <a class="code" href="md5_8h.html#8306a54d7d4073b1efe9602be8b1ba8d">MD5_BLOCK_SIZE</a>) {
<a name="l00354"></a>00354       process_block (md5_p, md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>, in_block &amp; ~<a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>);
<a name="l00355"></a>00355       <span class="comment">/* the regions in the following copy operation will not overlap. */</span>
<a name="l00356"></a>00356       memcpy (md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>,
<a name="l00357"></a>00357               md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a> + (in_block &amp; ~<a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>),
<a name="l00358"></a>00358               in_block &amp; <a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>);
<a name="l00359"></a>00359       md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a> = in_block &amp; BLOCK_SIZE_MASK;
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     buffer = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)buffer + <span class="keyword">add</span>;
<a name="l00363"></a>00363     len -= <span class="keyword">add</span>;
<a name="l00364"></a>00364   }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   <span class="comment">/* process available complete blocks right from the user buffer */</span>
<a name="l00367"></a>00367   <span class="keywordflow">if</span> (len &gt; <a class="code" href="md5_8h.html#8306a54d7d4073b1efe9602be8b1ba8d">MD5_BLOCK_SIZE</a>) {
<a name="l00368"></a>00368     process_block (md5_p, buffer, len &amp; ~<a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>);
<a name="l00369"></a>00369     buffer = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) buffer + (len &amp; ~<a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>);
<a name="l00370"></a>00370     len &amp;= <a class="code" href="md5__loc_8h.html#922a001b47a0d088e36929b15dafeee8">BLOCK_SIZE_MASK</a>;
<a name="l00371"></a>00371   }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="comment">/* copy remaining bytes into the internal buffer */</span>
<a name="l00374"></a>00374   <span class="keywordflow">if</span> (len &gt; 0) {
<a name="l00375"></a>00375     memcpy (md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>, buffer, len);
<a name="l00376"></a>00376     md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a> = len;
<a name="l00377"></a>00377   }
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">/*</span>
<a name="l00381"></a>00381 <span class="comment"> * md5_finish</span>
<a name="l00382"></a>00382 <span class="comment"> *</span>
<a name="l00383"></a>00383 <span class="comment"> * DESCRIPTION:</span>
<a name="l00384"></a>00384 <span class="comment"> *</span>
<a name="l00385"></a>00385 <span class="comment"> * Finish a progressing MD5 calculation and copy the resulting MD5</span>
<a name="l00386"></a>00386 <span class="comment"> * signature into the result buffer which should be 16 bytes</span>
<a name="l00387"></a>00387 <span class="comment"> * (MD5_SIZE).  After this call, the MD5 structure is invalid.</span>
<a name="l00388"></a>00388 <span class="comment"> *</span>
<a name="l00389"></a>00389 <span class="comment"> * RETURNS:</span>
<a name="l00390"></a>00390 <span class="comment"> *</span>
<a name="l00391"></a>00391 <span class="comment"> * None.</span>
<a name="l00392"></a>00392 <span class="comment"> *</span>
<a name="l00393"></a>00393 <span class="comment"> * ARGUMENTS:</span>
<a name="l00394"></a>00394 <span class="comment"> *</span>
<a name="l00395"></a>00395 <span class="comment"> * md5_p - Pointer to MD5 structure which we are finishing.</span>
<a name="l00396"></a>00396 <span class="comment"> *</span>
<a name="l00397"></a>00397 <span class="comment"> * signature - A 16 byte buffer that will contain the MD5 signature.</span>
<a name="l00398"></a>00398 <span class="comment"> */</span>
<a name="l00399"></a><a class="code" href="md5_8h.html#72e5f2ef4e06c2db4f98b15a2de5228b">00399</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#11ca5c562ccb658385f45552cd840a2c">md5_finish</a>(<a class="code" href="structmd5__t.html">md5_t</a> *md5_p, <span class="keywordtype">void</span> *signature)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401   <a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>    bytes, hold;
<a name="l00402"></a>00402   <span class="keywordtype">int</span>           pad;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <span class="comment">/* take yet unprocessed bytes into account */</span>
<a name="l00405"></a>00405   bytes = md5_p-&gt;<a class="code" href="structmd5__t.html#7bf7169ebc0df8192cd2c322b956d81b">md_buf_len</a>;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="comment">/*</span>
<a name="l00408"></a>00408 <span class="comment">   * Count remaining bytes.  Modified to do this to better avoid</span>
<a name="l00409"></a>00409 <span class="comment">   * overflows in the lower word -- Gray 10/97.</span>
<a name="l00410"></a>00410 <span class="comment">   */</span>
<a name="l00411"></a>00411   <span class="keywordflow">if</span> (md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] &gt; <a class="code" href="md5_8h.html#115bf68d9f4ca75cd56221a136ce689c">MAX_MD5_UINT32</a> - bytes) {
<a name="l00412"></a>00412     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[1]++;
<a name="l00413"></a>00413     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] -= (<a class="code" href="md5_8h.html#115bf68d9f4ca75cd56221a136ce689c">MAX_MD5_UINT32</a> + 1 - bytes);
<a name="l00414"></a>00414   }
<a name="l00415"></a>00415   <span class="keywordflow">else</span> {
<a name="l00416"></a>00416     md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] += bytes;
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="comment">/*</span>
<a name="l00420"></a>00420 <span class="comment">   * Pad the buffer to the next MD5_BLOCK-byte boundary.  (RFC 1321,</span>
<a name="l00421"></a>00421 <span class="comment">   * 3.1: Step 1).  We need enough room for two size words and the</span>
<a name="l00422"></a>00422 <span class="comment">   * bytes left in the buffer.  For some reason even if we are equal</span>
<a name="l00423"></a>00423 <span class="comment">   * to the block-size, we add an addition block of pad bytes.</span>
<a name="l00424"></a>00424 <span class="comment">   */</span>
<a name="l00425"></a>00425   pad = <a class="code" href="md5_8h.html#8306a54d7d4073b1efe9602be8b1ba8d">MD5_BLOCK_SIZE</a> - (<span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>) * 2) - bytes;
<a name="l00426"></a>00426   <span class="keywordflow">if</span> (pad &lt;= 0) {
<a name="l00427"></a>00427     pad += <a class="code" href="md5_8h.html#8306a54d7d4073b1efe9602be8b1ba8d">MD5_BLOCK_SIZE</a>;
<a name="l00428"></a>00428   }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430   <span class="comment">/*</span>
<a name="l00431"></a>00431 <span class="comment">   * Modified from a fixed array to this assignment and memset to be</span>
<a name="l00432"></a>00432 <span class="comment">   * more flexible with block-sizes -- Gray 10/97.</span>
<a name="l00433"></a>00433 <span class="comment">   */</span>
<a name="l00434"></a>00434   <span class="keywordflow">if</span> (pad &gt; 0) {
<a name="l00435"></a>00435     <span class="comment">/* some sort of padding start byte */</span>
<a name="l00436"></a>00436     md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>[bytes] = (<span class="keywordtype">unsigned</span> char)0x80;
<a name="l00437"></a>00437     <span class="keywordflow">if</span> (pad &gt; 1) {
<a name="l00438"></a>00438       memset (md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a> + bytes + 1, 0, pad - 1);
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440     bytes += pad;
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   <span class="comment">/*</span>
<a name="l00444"></a>00444 <span class="comment">   * Put the 64-bit file length in _bits_ (i.e. *8) at the end of the</span>
<a name="l00445"></a>00445 <span class="comment">   * buffer.  </span>
<a name="l00446"></a>00446 <span class="comment">   */</span>
<a name="l00447"></a>00447   hold = SWAP((md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] &amp; 0x1FFFFFFF) &lt;&lt; 3);
<a name="l00448"></a>00448   memcpy(md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a> + bytes, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00449"></a>00449   bytes += <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="comment">/* shift the high word over by 3 and add in the top 3 bits from the low */</span>
<a name="l00452"></a>00452   hold = SWAP((md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[1] &lt;&lt; 3) |
<a name="l00453"></a>00453               ((md5_p-&gt;<a class="code" href="structmd5__t.html#9169c98caf650a252cd2dbf3e4544498">md_total</a>[0] &amp; 0xE0000000) &gt;&gt; 29));
<a name="l00454"></a>00454   memcpy(md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a> + bytes, &amp;hold, <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>));
<a name="l00455"></a>00455   bytes += <span class="keyword">sizeof</span>(<a class="code" href="md5_8h.html#a5370400843756f0b77b782bdeef2564">md5_uint32</a>);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   <span class="comment">/* process last bytes, the padding chars, and size words */</span>
<a name="l00458"></a>00458   process_block(md5_p, md5_p-&gt;<a class="code" href="structmd5__t.html#ce5d5c1497a2793065a7abf0d8bccde9">md_buffer</a>, bytes);
<a name="l00459"></a>00459   md5_get_result(md5_p, signature);
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <span class="comment">/*</span>
<a name="l00463"></a>00463 <span class="comment"> * md5_buffer</span>
<a name="l00464"></a>00464 <span class="comment"> *</span>
<a name="l00465"></a>00465 <span class="comment"> * DESCRIPTION:</span>
<a name="l00466"></a>00466 <span class="comment"> *</span>
<a name="l00467"></a>00467 <span class="comment"> * This function is used to calculate a MD5 signature for a buffer of</span>
<a name="l00468"></a>00468 <span class="comment"> * bytes.  If you only have part of a buffer that you want to process</span>
<a name="l00469"></a>00469 <span class="comment"> * then md5_init, md5_process, and md5_finish should be used.</span>
<a name="l00470"></a>00470 <span class="comment"> *</span>
<a name="l00471"></a>00471 <span class="comment"> * RETURNS:</span>
<a name="l00472"></a>00472 <span class="comment"> *</span>
<a name="l00473"></a>00473 <span class="comment"> * None.</span>
<a name="l00474"></a>00474 <span class="comment"> *</span>
<a name="l00475"></a>00475 <span class="comment"> * ARGUMENTS:</span>
<a name="l00476"></a>00476 <span class="comment"> *</span>
<a name="l00477"></a>00477 <span class="comment"> * buffer - A buffer of bytes whose MD5 signature we are calculating.</span>
<a name="l00478"></a>00478 <span class="comment"> *</span>
<a name="l00479"></a>00479 <span class="comment"> * buf_len - The length of the buffer.</span>
<a name="l00480"></a>00480 <span class="comment"> *</span>
<a name="l00481"></a>00481 <span class="comment"> * signature - A 16 byte buffer that will contain the MD5 signature.</span>
<a name="l00482"></a>00482 <span class="comment"> */</span>
<a name="l00483"></a><a class="code" href="md5_8h.html#975b91095e7b86642f360d060dd2f8db">00483</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#f5de8c04dba53defbfbdd955ca7d19ab">md5_buffer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buf_len,
<a name="l00484"></a>00484                    <span class="keywordtype">void</span> *signature)
<a name="l00485"></a>00485 {
<a name="l00486"></a>00486   <a class="code" href="structmd5__t.html">md5_t</a>         md5;
<a name="l00487"></a>00487 
<a name="l00488"></a>00488   <span class="comment">/* initialize the computation context */</span>
<a name="l00489"></a>00489   <a class="code" href="md5_8cpp.html#4534cfa15307cc94f1e557fb6238698e">md5_init</a>(&amp;md5);
<a name="l00490"></a>00490 
<a name="l00491"></a>00491   <span class="comment">/* process whole buffer but last buf_len % MD5_BLOCK bytes */</span>
<a name="l00492"></a>00492   <a class="code" href="md5_8cpp.html#39eb2828c65f0846e6894a04df859f5c">md5_process</a>(&amp;md5, buffer, buf_len);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <span class="comment">/* put result in desired memory area */</span>
<a name="l00495"></a>00495   <a class="code" href="md5_8cpp.html#11ca5c562ccb658385f45552cd840a2c">md5_finish</a>(&amp;md5, signature);
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">/*</span>
<a name="l00499"></a>00499 <span class="comment"> * md5_sig_to_string</span>
<a name="l00500"></a>00500 <span class="comment"> *</span>
<a name="l00501"></a>00501 <span class="comment"> * DESCRIPTION:</span>
<a name="l00502"></a>00502 <span class="comment"> *</span>
<a name="l00503"></a>00503 <span class="comment"> * Convert a MD5 signature in a 16 byte buffer into a hexadecimal string</span>
<a name="l00504"></a>00504 <span class="comment"> * representation.</span>
<a name="l00505"></a>00505 <span class="comment"> *</span>
<a name="l00506"></a>00506 <span class="comment"> * RETURNS:</span>
<a name="l00507"></a>00507 <span class="comment"> *</span>
<a name="l00508"></a>00508 <span class="comment"> * None.</span>
<a name="l00509"></a>00509 <span class="comment"> *</span>
<a name="l00510"></a>00510 <span class="comment"> * ARGUMENTS:</span>
<a name="l00511"></a>00511 <span class="comment"> *</span>
<a name="l00512"></a>00512 <span class="comment"> * signature - a 16 byte buffer that contains the MD5 signature.</span>
<a name="l00513"></a>00513 <span class="comment"> *</span>
<a name="l00514"></a>00514 <span class="comment"> * str - a string of charactes which should be at least 33 bytes long (2</span>
<a name="l00515"></a>00515 <span class="comment"> * characters per MD5 byte and 1 for the \0).</span>
<a name="l00516"></a>00516 <span class="comment"> *</span>
<a name="l00517"></a>00517 <span class="comment"> * str_len - the length of the string.</span>
<a name="l00518"></a>00518 <span class="comment"> */</span>
<a name="l00519"></a><a class="code" href="md5_8h.html#0f4331b29464a71b266fda74c0edd8a7">00519</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#30e614459448b9ac45c84793392eea91">md5_sig_to_string</a>(<span class="keywordtype">void</span> *signature, <span class="keywordtype">char</span> *str, <span class="keyword">const</span> <span class="keywordtype">int</span> str_len)
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sig_p;
<a name="l00522"></a>00522   <span class="keywordtype">char</span>          *str_p, *max_p;
<a name="l00523"></a>00523   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  high, low;
<a name="l00524"></a>00524   
<a name="l00525"></a>00525   str_p = str;
<a name="l00526"></a>00526   max_p = str + str_len;
<a name="l00527"></a>00527   
<a name="l00528"></a>00528   <span class="keywordflow">for</span> (sig_p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)signature;
<a name="l00529"></a>00529        sig_p &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)signature + <a class="code" href="md5_8h.html#346b45663bfa5a41fb49acad0845bfd8">MD5_SIZE</a>;
<a name="l00530"></a>00530        sig_p++) {
<a name="l00531"></a>00531     high = *sig_p / 16;
<a name="l00532"></a>00532     low = *sig_p % 16;
<a name="l00533"></a>00533     <span class="comment">/* account for 2 chars */</span>
<a name="l00534"></a>00534     <span class="keywordflow">if</span> (str_p + 1 &gt;= max_p) {
<a name="l00535"></a>00535       <span class="keywordflow">break</span>;
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537     *str_p++ = <a class="code" href="md5__loc_8h.html#edbcc427391a12db8072aa23472b2c18">HEX_STRING</a>[high];
<a name="l00538"></a>00538     *str_p++ = <a class="code" href="md5__loc_8h.html#edbcc427391a12db8072aa23472b2c18">HEX_STRING</a>[low];
<a name="l00539"></a>00539   }
<a name="l00540"></a>00540   <span class="comment">/* account for 2 chars */</span>
<a name="l00541"></a>00541   <span class="keywordflow">if</span> (str_p &lt; max_p) {
<a name="l00542"></a>00542     *str_p++ = <span class="charliteral">'\0'</span>;
<a name="l00543"></a>00543   }
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">/*</span>
<a name="l00547"></a>00547 <span class="comment"> * md5_sig_from_string</span>
<a name="l00548"></a>00548 <span class="comment"> *</span>
<a name="l00549"></a>00549 <span class="comment"> * DESCRIPTION:</span>
<a name="l00550"></a>00550 <span class="comment"> *</span>
<a name="l00551"></a>00551 <span class="comment"> * Convert a MD5 signature from a hexadecimal string representation into</span>
<a name="l00552"></a>00552 <span class="comment"> * a 16 byte buffer.</span>
<a name="l00553"></a>00553 <span class="comment"> *</span>
<a name="l00554"></a>00554 <span class="comment"> * RETURNS:</span>
<a name="l00555"></a>00555 <span class="comment"> *</span>
<a name="l00556"></a>00556 <span class="comment"> * None.</span>
<a name="l00557"></a>00557 <span class="comment"> *</span>
<a name="l00558"></a>00558 <span class="comment"> * ARGUMENTS:</span>
<a name="l00559"></a>00559 <span class="comment"> *</span>
<a name="l00560"></a>00560 <span class="comment"> * signature - A 16 byte buffer that will contain the MD5 signature.</span>
<a name="l00561"></a>00561 <span class="comment"> *</span>
<a name="l00562"></a>00562 <span class="comment"> * str - A string of charactes which _must_ be at least 32 bytes long (2</span>
<a name="l00563"></a>00563 <span class="comment"> * characters per MD5 byte).</span>
<a name="l00564"></a>00564 <span class="comment"> */</span>
<a name="l00565"></a><a class="code" href="md5_8h.html#47c9c3ea0284cf6283dc3de13a181c0a">00565</a> <span class="keywordtype">void</span>    <a class="code" href="md5_8cpp.html#5f13b2aafa1b2ccc8cda48990711c5b7">md5_sig_from_string</a>(<span class="keywordtype">void</span> *signature, <span class="keyword">const</span> <span class="keywordtype">char</span> *str)
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sig_p;
<a name="l00568"></a>00568   <span class="keyword">const</span> <span class="keywordtype">char</span>    *str_p;
<a name="l00569"></a>00569   <span class="keywordtype">char</span>          *hex;
<a name="l00570"></a>00570   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  high, low, val;
<a name="l00571"></a>00571   
<a name="l00572"></a>00572   hex = <a class="code" href="md5__loc_8h.html#edbcc427391a12db8072aa23472b2c18">HEX_STRING</a>;
<a name="l00573"></a>00573   sig_p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)signature;
<a name="l00574"></a>00574   
<a name="l00575"></a>00575   <span class="keywordflow">for</span> (str_p = str; str_p &lt; str + <a class="code" href="md5_8h.html#346b45663bfa5a41fb49acad0845bfd8">MD5_SIZE</a> * 2; str_p += 2) {
<a name="l00576"></a>00576     high = strchr(hex, *str_p) - hex;
<a name="l00577"></a>00577     low = strchr(hex, *(str_p + 1)) - hex;
<a name="l00578"></a>00578     val = high * 16 + low;
<a name="l00579"></a>00579     *sig_p++ = val;
<a name="l00580"></a>00580   }
<a name="l00581"></a>00581 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 30 09:36:03 2008 for BEO-Timing by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
