<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BEO-Timing: tableeditdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>tableeditdialog.cpp</h1><a href="tableeditdialog_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="tableeditdialog_8h.html" title="Dieser Dialog dient dem Editieren der Eintraege.">tableeditdialog.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="_resultate_delegate_8h.html" title="Diese Klasse bildet die Schnittstelle zwischen der Resultateeditiertabelle und der...">delegates/ResultateDelegate.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="_kontakt_delegate_8h.html" title="Diese Klasse bildet die Schnittstelle zwischen der Kontakteditiertabelle und der...">delegates/KontaktDelegate.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="_user_8h.html" title="Diese Klasse symbolisiert einen Benutzer und stellt Funktionen bereit.">User.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;QtSql&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;QtGui&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00045"></a><a class="code" href="class_table_edit_dialog.html#f1bf42b072c27aeb0eb3f29d497a0a8f">00045</a> <a class="code" href="class_table_edit_dialog.html#f1bf42b072c27aeb0eb3f29d497a0a8f" title="Konstruktor.">TableEditDialog::TableEditDialog</a>(<span class="keywordtype">int</span> TeilnehmerKeyParam, <a class="code" href="class_user.html" title="Diese Klasse symbolisiert einen Benutzer und stellt Funktionen bereit.">User</a>* user, QWidget *parent)
<a name="l00046"></a>00046     : QDialog(parent)
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048         <a class="code" href="class_table_edit_dialog.html#f63889b474e6ccf0d2dc0d7c1deb44c9">ui</a>.<a class="code" href="class_ui___table_edit_dialog_class.html#a2daa38830f3a3d673e96af45346c219">setupUi</a>(<span class="keyword">this</span>);
<a name="l00049"></a>00049         <span class="comment">// parent zu Pointer für das Hauptfenster casten</span>
<a name="l00050"></a>00050         this-&gt;<a class="code" href="class_table_edit_dialog.html#91a07844cd384a7efa73a77d2e168586">mainWindow</a>=(<a class="code" href="class_b_e_o___timing.html" title="Hauptklasse der Applikation.">BEO_Timing</a>*)parent;
<a name="l00051"></a>00051         qDebug() &lt;&lt; TeilnehmerKeyParam;
<a name="l00052"></a>00052         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a> = <a class="code" href="class_table_edit_dialog.html#f63889b474e6ccf0d2dc0d7c1deb44c9">ui</a>.<a class="code" href="class_ui___table_edit_dialog_class.html#49cbc22d11fa57a282ac9e3b9a93fadd">ResultateTable</a>;
<a name="l00053"></a>00053         <span class="comment">// Tabelle für die Kontaktdaten mit dem QSqlTableModel erstellen</span>
<a name="l00054"></a>00054         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a> = <a class="code" href="class_table_edit_dialog.html#f63889b474e6ccf0d2dc0d7c1deb44c9">ui</a>.<a class="code" href="class_ui___table_edit_dialog_class.html#7127dc0106c562fc097ca9be9ba55b03">KontaktdatenTable</a>;
<a name="l00055"></a>00055         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a> = <span class="keyword">new</span> QSqlTableModel(<a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>);
<a name="l00056"></a>00056         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setTable(<span class="stringliteral">"teilnehmer"</span>);
<a name="l00057"></a>00057         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setFilter(<span class="stringliteral">"TeilnehmerKey='"</span> + QString::number(TeilnehmerKeyParam) + <span class="stringliteral">"'"</span>);
<a name="l00058"></a>00058         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;select();
<a name="l00059"></a>00059         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setEditStrategy(QSqlTableModel::OnManualSubmit);
<a name="l00060"></a>00060         qDebug() &lt;&lt; <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;lastError();
<a name="l00061"></a>00061         <span class="comment">// Headerdaten der Tabelle setzen</span>
<a name="l00062"></a>00062         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7daaee1ae13160b7122146d6be94078b9">TeilnehmerKey</a>, Qt::Horizontal, tr(<span class="stringliteral">"TeilnehmerKey"</span>));
<a name="l00063"></a>00063         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc762ac34273d46592d74466bed3e93b65d">Name</a>, Qt::Horizontal, tr(<span class="stringliteral">"Name"</span>));
<a name="l00064"></a>00064         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc748fd0828072976d7bde192a59ca24225">Vorname</a>, Qt::Horizontal, tr(<span class="stringliteral">"Vorname"</span>));
<a name="l00065"></a>00065         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7b488b973a9c87959710052ee0539cdd1">Adresse</a>, Qt::Horizontal, tr(<span class="stringliteral">"Adresse"</span>));
<a name="l00066"></a>00066         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7779f4c8a7a891f73695bfd7d4a827d2e">PLZ</a>, Qt::Horizontal, tr(<span class="stringliteral">"PLZ"</span>));
<a name="l00067"></a>00067         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7f0e8d2dc5ab13e67e64dcddeb97793b0">Ort</a>, Qt::Horizontal, tr(<span class="stringliteral">"Ort"</span>));
<a name="l00068"></a>00068         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7fef4aebc1c99e649ee63f9716efc6558">Jahrgang</a>, Qt::Horizontal, tr(<span class="stringliteral">"Jahrgang"</span>));
<a name="l00069"></a>00069         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7cc1bf0df502b7297c40bbda093263308">Geschlecht</a>, Qt::Horizontal, tr(<span class="stringliteral">"Geschlecht"</span>));
<a name="l00070"></a>00070         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc77d2d971c7111901b1741a3b25816790c">Nationalitaet</a>, Qt::Horizontal, tr(<span class="stringliteral">"Nationalität"</span>));
<a name="l00071"></a>00071         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7edf90a84d265a4ef25f9dc97eeaab9d1">Team_Club</a>, Qt::Horizontal, tr(<span class="stringliteral">"Team / Club"</span>));
<a name="l00072"></a>00072         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc75f5c8aded8722631927d1da12be33915">Email</a>, Qt::Horizontal, tr(<span class="stringliteral">"Email"</span>));
<a name="l00073"></a>00073         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc76c511d5234e9cce6a3f0ebf9353155ea">Telefon</a>, Qt::Horizontal, tr(<span class="stringliteral">"Telefon"</span>));
<a name="l00074"></a>00074         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7b39d889b9563fe65457190bdb4758452">Mobile</a>, Qt::Horizontal, tr(<span class="stringliteral">"Mobile"</span>));
<a name="l00075"></a>00075         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc72fb86b56b24ca9716876528d4e215af9">RFID_SNR</a>, Qt::Horizontal, tr(<span class="stringliteral">"RFID-Snr"</span>));
<a name="l00076"></a>00076         <span class="comment">// Ansicht mit Modell verbinden</span>
<a name="l00077"></a>00077         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setModel(<a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>);
<a name="l00078"></a>00078         <span class="comment">// Auswahlmöglichkeiten definieren</span>
<a name="l00079"></a>00079         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setSelectionMode(QAbstractItemView::SingleSelection);
<a name="l00080"></a>00080         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setSelectionBehavior(QAbstractItemView::SelectItems);
<a name="l00081"></a>00081         <span class="comment">// Spaltenbreite einstellen</span>
<a name="l00082"></a>00082         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;resizeColumnsToContents();
<a name="l00083"></a>00083         <span class="comment">// Bearbeitungsmöglichkeiten einstellen</span>
<a name="l00084"></a>00084         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setEditTriggers(QAbstractItemView::DoubleClicked|QAbstractItemView::EditKeyPressed);
<a name="l00085"></a>00085         QHeaderView * header = <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;horizontalHeader();
<a name="l00086"></a>00086         header-&gt;setStretchLastSection(<span class="keyword">true</span>);
<a name="l00087"></a>00087         <span class="comment">// Eigene Delegateklasse als Schnittstelle zwischen dem Modell und der Ansicht definieren</span>
<a name="l00088"></a>00088         <span class="comment">// siehe "KontaktDelegate.cpp"</span>
<a name="l00089"></a>00089         <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setItemDelegate(<span class="keyword">new</span> <a class="code" href="class_kontakt_delegate.html" title="Diese Klasse bildet die Schnittstelle zwischen der Kontakteditiertabelle und der...">KontaktDelegate</a>());
<a name="l00090"></a>00090         
<a name="l00091"></a>00091         <span class="comment">// Erstellen der Tabelle für die Fahrzeiten mit dem QSqlTableModel</span>
<a name="l00092"></a>00092         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a> = <span class="keyword">new</span> QSqlTableModel(<a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>);
<a name="l00093"></a>00093         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setTable(<span class="stringliteral">"zeiten"</span>);
<a name="l00094"></a>00094         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setFilter(<span class="stringliteral">"TeilnehmerKey='"</span> + QString::number(TeilnehmerKeyParam) + <span class="stringliteral">"'"</span>);
<a name="l00095"></a>00095         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;select();
<a name="l00096"></a>00096         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setEditStrategy(QSqlTableModel::OnManualSubmit);
<a name="l00097"></a>00097         qDebug() &lt;&lt; <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;lastError();
<a name="l00098"></a>00098         <span class="comment">// Headerdaten setzen</span>
<a name="l00099"></a>00099         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5e01a69b6f9385d89c33fe1c369a3a589">TimeKey</a>, Qt::Horizontal, tr(<span class="stringliteral">"TimeKey"</span>));
<a name="l00100"></a>00100         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5a6658fe4dfede6c6e65a29e7a607b7b0">Eintrag</a>, Qt::Horizontal, tr(<span class="stringliteral">"Eintrag"</span>));
<a name="l00101"></a>00101         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5fc61d637022cc07e5b46cd6a8bd882bf">Startzeit</a>, Qt::Horizontal, tr(<span class="stringliteral">"Startzeit"</span>));
<a name="l00102"></a>00102         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5261fca6b87d7710b1cc5fcb64cfb8c9f">Endzeit</a>, Qt::Horizontal, tr(<span class="stringliteral">"Endzeit"</span>));
<a name="l00103"></a>00103         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5203d607fc2584a81d53495a35183e952">StreckenKey</a>, Qt::Horizontal, tr(<span class="stringliteral">"StreckenKey"</span>));
<a name="l00104"></a>00104         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5d2a2f3db2f2db22f77d5c8b7fadafaa1">TeilnehmerKey2</a>, Qt::Horizontal, tr(<span class="stringliteral">"TeilnehmerKey"</span>));
<a name="l00105"></a>00105         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5bb66db8c440e8819c4cc9ba3ecf7fcf7">Kategorie</a>, Qt::Horizontal, tr(<span class="stringliteral">"Kategorie"</span>));
<a name="l00106"></a>00106         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5db099451e2967b3fe3045f7644a2c1b6">Fahrzeit</a>, Qt::Horizontal, tr(<span class="stringliteral">"Fahrzeit"</span>));
<a name="l00107"></a>00107         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5ea3908e03a61ca36d77168ec1560e7a1">SNR_RFID</a>, Qt::Horizontal, tr(<span class="stringliteral">"SNR_RFID"</span>));
<a name="l00108"></a>00108         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;setHeaderData(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c570fa99606b59738c81764ff50d9a3429">TimeID</a>, Qt::Horizontal, tr(<span class="stringliteral">"TimeID"</span>));
<a name="l00109"></a>00109         <span class="comment">// Modell mit der Ansicht verbinden</span>
<a name="l00110"></a>00110         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setModel(<a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>);
<a name="l00111"></a>00111         <span class="comment">// Auswahlmöglichkeiten beschränken</span>
<a name="l00112"></a>00112         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setSelectionMode(QAbstractItemView::SingleSelection);
<a name="l00113"></a>00113         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setSelectionBehavior(QAbstractItemView::SelectItems);
<a name="l00114"></a>00114         <span class="comment">// Spaltenbreite anpassen</span>
<a name="l00115"></a>00115         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;resizeColumnsToContents();
<a name="l00116"></a>00116         <span class="comment">// Bearbeitungsmöglichkeiten definieren</span>
<a name="l00117"></a>00117         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setEditTriggers(QAbstractItemView::DoubleClicked|QAbstractItemView::EditKeyPressed);
<a name="l00118"></a>00118         header = <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;horizontalHeader();
<a name="l00119"></a>00119         header-&gt;setStretchLastSection(<span class="keyword">true</span>);
<a name="l00120"></a>00120         <span class="comment">// Eigene Delegateklasse als Schnittstelle zwischen dem Modell und der Ansicht definieren</span>
<a name="l00121"></a>00121         <span class="comment">// siehe "ResultateDelegate.cpp"</span>
<a name="l00122"></a>00122         <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setItemDelegate(<span class="keyword">new</span> <a class="code" href="class_resultate_delegate.html" title="Diese Klasse bildet die Schnittstelle zwischen der Resultateeditiertabelle und der...">ResultateDelegate</a>());
<a name="l00123"></a>00123         
<a name="l00124"></a>00124         <span class="comment">// Angezeigte Spalten, je nach Berechtigung des angemeldeten Benutzers</span>
<a name="l00125"></a>00125         <span class="keywordflow">if</span>(user-&gt;<a class="code" href="class_user.html#f6482cc57caa04a2c718fb059b2c1336" title="Gibt den Usertype zurück.">getUsertype</a>() &gt;= <a class="code" href="class_table_edit_dialog.html#fc63d051c5c8dff3412065d3c49ba7fd669d220d082a679ea8db9f7928f3d458">administrator</a>){
<a name="l00126"></a>00126                 <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc7daaee1ae13160b7122146d6be94078b9">TeilnehmerKey</a>,<span class="keyword">true</span>);
<a name="l00127"></a>00127                 <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5d2a2f3db2f2db22f77d5c8b7fadafaa1">TeilnehmerKey2</a>,<span class="keyword">true</span>);
<a name="l00128"></a>00128                 <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5203d607fc2584a81d53495a35183e952">StreckenKey</a>,<span class="keyword">true</span>);
<a name="l00129"></a>00129                 <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5e01a69b6f9385d89c33fe1c369a3a589">TimeKey</a>,<span class="keyword">true</span>);
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131         <span class="keywordflow">if</span>(user-&gt;<a class="code" href="class_user.html#f6482cc57caa04a2c718fb059b2c1336" title="Gibt den Usertype zurück.">getUsertype</a>() &gt;= <a class="code" href="class_table_edit_dialog.html#fc63d051c5c8dff3412065d3c49ba7fd8aa81aa302567502aca18faf757675f6">manager</a>){
<a name="l00132"></a>00132                 <a class="code" href="class_table_edit_dialog.html#a6e15d4f17c02c81f8a1221ed1e789b5">kontaktView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#86c177ed9439b08e0b6cfc902a3d2cc72fb86b56b24ca9716876528d4e215af9">RFID_SNR</a>,<span class="keyword">true</span>);
<a name="l00133"></a>00133                 <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;setColumnHidden(<a class="code" href="class_table_edit_dialog.html#bece1e406d8effa6b198f777247779c5ea3908e03a61ca36d77168ec1560e7a1">SNR_RFID</a>,<span class="keyword">true</span>);
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135         <span class="comment">// Ort der Änderungen speichern</span>
<a name="l00136"></a>00136     <a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a> = <span class="keyword">new</span> QModelIndexList();
<a name="l00137"></a>00137     <a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a> = <span class="keyword">new</span> QModelIndexList();
<a name="l00138"></a>00138         connect(<a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>,
<a name="l00139"></a>00139                         SIGNAL(dataChanged(<span class="keyword">const</span> QModelIndex, <span class="keyword">const</span> QModelIndex)),
<a name="l00140"></a>00140                         <span class="keyword">this</span>,
<a name="l00141"></a>00141                         SLOT(<a class="code" href="class_table_edit_dialog.html#24028bd71ab1cee427967807e85e29fe" title="Slot um Datenänderungen im Model in einer Liste zu speichern.">on_kontakte_dataChanged</a>(<span class="keyword">const</span> QModelIndex, <span class="keyword">const</span> QModelIndex))
<a name="l00142"></a>00142                         );
<a name="l00143"></a>00143         connect(<a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>,
<a name="l00144"></a>00144                         SIGNAL(dataChanged(<span class="keyword">const</span> QModelIndex, <span class="keyword">const</span> QModelIndex)),
<a name="l00145"></a>00145                         <span class="keyword">this</span>,
<a name="l00146"></a>00146                         SLOT(<a class="code" href="class_table_edit_dialog.html#d09fb68dc6ea3de8056d088099db6b67" title="Slot um Datenänderungen im Model in einer Liste zu speichern.">on_resultate_dataChanged</a>(<span class="keyword">const</span> QModelIndex, <span class="keyword">const</span> QModelIndex))
<a name="l00147"></a>00147                         );
<a name="l00148"></a>00148 }
<a name="l00152"></a><a class="code" href="class_table_edit_dialog.html#cb768ab9eaca499eee124debc9762067">00152</a> <a class="code" href="class_table_edit_dialog.html#cb768ab9eaca499eee124debc9762067" title="Destruktor.">TableEditDialog::~TableEditDialog</a>()
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154         
<a name="l00155"></a>00155 }
<a name="l00159"></a><a class="code" href="class_table_edit_dialog.html#0ccad25795df2d282741c21eeca778e6">00159</a> <span class="keywordtype">void</span> <a class="code" href="class_table_edit_dialog.html#0ccad25795df2d282741c21eeca778e6" title="Slot für Löschen-Button.">TableEditDialog::on_loeschenButton_released</a>(){
<a name="l00160"></a>00160         <span class="keywordtype">int</span> selected;
<a name="l00161"></a>00161         <span class="comment">// Warnung ausgeben </span>
<a name="l00162"></a>00162         QMessageBox msgBox;
<a name="l00163"></a>00163         QPushButton *loeschenButton = msgBox.addButton(tr(<span class="stringliteral">"OK"</span>), QMessageBox::ActionRole);
<a name="l00164"></a>00164         QPushButton *abortButton = msgBox.addButton(tr(<span class="stringliteral">"Abbrechen"</span>), QMessageBox::ActionRole);
<a name="l00165"></a>00165         msgBox.setDefaultButton(abortButton);
<a name="l00166"></a>00166         msgBox.setEscapeButton(abortButton);
<a name="l00167"></a>00167         msgBox.setText(tr(<span class="stringliteral">"Die ausgewählte Zeile wird gelöscht. Diese Aktion kann nicht Rückgängig gemacht werden!"</span>));
<a name="l00168"></a>00168         msgBox.setWindowTitle(tr(<span class="stringliteral">"Bestätigen des Löschvorgangs"</span>));
<a name="l00169"></a>00169         msgBox.setIcon(QMessageBox::Warning);
<a name="l00170"></a>00170         msgBox.exec();
<a name="l00171"></a>00171         <span class="comment">// Zeile im Modell löschen, falls bestätigt</span>
<a name="l00172"></a>00172         <span class="keywordflow">if</span>(msgBox.clickedButton() == loeschenButton){
<a name="l00173"></a>00173                 QItemSelectionModel* <a class="code" href="_master_r_d_8h.html#234be45c406c2d8d2489673913eecfd4">model</a> = <a class="code" href="class_table_edit_dialog.html#3ae273e36ee898643059e8963ed9f557">resultateView</a>-&gt;selectionModel();
<a name="l00174"></a>00174                 <span class="keywordflow">if</span>(model-&gt;hasSelection()){
<a name="l00175"></a>00175                         selected=model-&gt;selection().indexes().at(0).row();
<a name="l00176"></a>00176                         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;removeRow(selected);
<a name="l00177"></a>00177                 }
<a name="l00178"></a>00178                 <span class="comment">// Änderungen an die DB übermitteln</span>
<a name="l00179"></a>00179                 <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;submitAll();
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 }
<a name="l00185"></a><a class="code" href="class_table_edit_dialog.html#b3ae208e0e028f4030875efe33e3de48">00185</a> <span class="keywordtype">void</span> <a class="code" href="class_table_edit_dialog.html#b3ae208e0e028f4030875efe33e3de48" title="Slot für Bestätigen-Button.">TableEditDialog::on_BestaetigenButton_released</a>(){
<a name="l00186"></a>00186         <span class="comment">// Änderungen anzeigen</span>
<a name="l00187"></a>00187         QMessageBox msgBox;
<a name="l00188"></a>00188         QPushButton *bestaetigenButton = msgBox.addButton(tr(<span class="stringliteral">"OK"</span>), QMessageBox::ActionRole);
<a name="l00189"></a>00189         QPushButton *abortButton = msgBox.addButton(tr(<span class="stringliteral">"Abbrechen"</span>), QMessageBox::ActionRole);
<a name="l00190"></a>00190         msgBox.setDefaultButton(abortButton);
<a name="l00191"></a>00191         msgBox.setEscapeButton(abortButton);
<a name="l00192"></a>00192         QString text = <span class="stringliteral">"Die folgenden Änderungen werden übernommen:\n\n"</span>;
<a name="l00193"></a>00193         text += <span class="stringliteral">"Kontaktinformationen (Zeile, Spalte):\n"</span>;
<a name="l00194"></a>00194         <span class="comment">// (Kontakte) Anzeigen, falls nicht leer</span>
<a name="l00195"></a>00195         <span class="keywordflow">if</span>(!<a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;empty()){
<a name="l00196"></a>00196                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;count();++i){
<a name="l00197"></a>00197                         text += <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;data(<a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;at(i)).toString() + <span class="stringliteral">" ("</span> +
<a name="l00198"></a>00198                                 QString::number(<a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;at(i).row()+1) + <span class="stringliteral">", "</span> +
<a name="l00199"></a>00199                                 QString::number(<a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;at(i).column()+1) + <span class="stringliteral">")\n"</span>;
<a name="l00200"></a>00200                 }
<a name="l00201"></a>00201                 <span class="comment">// Speicher zurücksetzen</span>
<a name="l00202"></a>00202                 <a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;clear();
<a name="l00203"></a>00203         }<span class="keywordflow">else</span>{
<a name="l00204"></a>00204                 text += <span class="stringliteral">"keine\n"</span>;
<a name="l00205"></a>00205         }
<a name="l00206"></a>00206         text += <span class="stringliteral">"\nResultate (Zeile, Spalte):\n"</span>;
<a name="l00207"></a>00207         <span class="keywordflow">if</span>(!<a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;empty()){
<a name="l00208"></a>00208                 <span class="comment">// (Zeiten) Anzeigen, falls nicht leer</span>
<a name="l00209"></a>00209                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;count();++i){
<a name="l00210"></a>00210                         text += <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;data(<a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;at(i)).toString() + <span class="stringliteral">" ("</span> +
<a name="l00211"></a>00211                                 QString::number(<a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;at(i).row()+1) + <span class="stringliteral">", "</span> +
<a name="l00212"></a>00212                                 QString::number(<a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;at(i).column()+1) + <span class="stringliteral">")\n"</span>;
<a name="l00213"></a>00213                 }
<a name="l00214"></a>00214                 <span class="comment">// Speicher zurücksetzen</span>
<a name="l00215"></a>00215                 <a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;clear();
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217         text += <span class="stringliteral">"\nDiese Aktion kann nicht Rückgängig gemacht werden!"</span>;
<a name="l00218"></a>00218         msgBox.setText(text);
<a name="l00219"></a>00219         msgBox.setWindowTitle(tr(<span class="stringliteral">"Bestätigen der Änderungen"</span>));
<a name="l00220"></a>00220         msgBox.setIcon(QMessageBox::Question);
<a name="l00221"></a>00221         msgBox.exec();
<a name="l00222"></a>00222         <span class="comment">// Übermitteln, falls bestätigt</span>
<a name="l00223"></a>00223         <span class="keywordflow">if</span>(msgBox.clickedButton() == bestaetigenButton){
<a name="l00224"></a>00224                 <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;submitAll();
<a name="l00225"></a>00225                 <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;submitAll();
<a name="l00226"></a>00226         }
<a name="l00227"></a>00227         <span class="comment">// Argument '0' bedeutet in Baum ausgewähltes Rennen neu vom Server lesen</span>
<a name="l00228"></a>00228         <a class="code" href="class_table_edit_dialog.html#91a07844cd384a7efa73a77d2e168586">mainWindow</a>-&gt;<a class="code" href="class_b_e_o___timing.html#b54fe6db69d9304c6c27bf3b4c253196" title="Stellt die Rangliste dar.">Read_Race</a>(0);
<a name="l00229"></a>00229 }
<a name="l00233"></a><a class="code" href="class_table_edit_dialog.html#d10a162c0554577a222a34cd918e3d1f">00233</a> <span class="keywordtype">void</span> <a class="code" href="class_table_edit_dialog.html#d10a162c0554577a222a34cd918e3d1f" title="Slot für Verwerfen-Button.">TableEditDialog::on_VerwerfenButton_released</a>(){
<a name="l00234"></a>00234         <span class="comment">// Änderungen im Model verwerfen und Dialog schliessen</span>
<a name="l00235"></a>00235         <a class="code" href="class_table_edit_dialog.html#2bccfca0a956c1fe7e4272e435456b8e">kontaktModel</a>-&gt;revertAll();
<a name="l00236"></a>00236         <a class="code" href="class_table_edit_dialog.html#c544c898094d550a4df24603738d576d">resultateModel</a>-&gt;revertAll();
<a name="l00237"></a>00237         this-&gt;close();
<a name="l00238"></a>00238 }
<a name="l00244"></a><a class="code" href="class_table_edit_dialog.html#24028bd71ab1cee427967807e85e29fe">00244</a> <span class="keywordtype">void</span> <a class="code" href="class_table_edit_dialog.html#24028bd71ab1cee427967807e85e29fe" title="Slot um Datenänderungen im Model in einer Liste zu speichern.">TableEditDialog::on_kontakte_dataChanged</a>(<span class="keyword">const</span> QModelIndex &amp; topLeft, <span class="keyword">const</span> QModelIndex &amp; bottomRight){
<a name="l00245"></a>00245         <a class="code" href="class_table_edit_dialog.html#779a6767b90cf2a0f67d4fd3a0eef79e">kontakteChanged</a>-&gt;append(topLeft);
<a name="l00246"></a>00246 }
<a name="l00252"></a><a class="code" href="class_table_edit_dialog.html#d09fb68dc6ea3de8056d088099db6b67">00252</a> <span class="keywordtype">void</span> <a class="code" href="class_table_edit_dialog.html#d09fb68dc6ea3de8056d088099db6b67" title="Slot um Datenänderungen im Model in einer Liste zu speichern.">TableEditDialog::on_resultate_dataChanged</a>(<span class="keyword">const</span> QModelIndex &amp; topLeft, <span class="keyword">const</span> QModelIndex &amp; bottomRight){
<a name="l00253"></a>00253         <a class="code" href="class_table_edit_dialog.html#9bc0694e38258f5d52f1b2abf65f7ba3">resultateChanged</a>-&gt;append(topLeft);
<a name="l00254"></a>00254 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 30 09:36:03 2008 for BEO-Timing by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
